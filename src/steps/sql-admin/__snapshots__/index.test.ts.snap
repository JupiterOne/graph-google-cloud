// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`#buildSqlAdminInstanceKmsKeyRelationships should collect data 1`] = `
Object {
  "collectedEntities": Array [
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:43.324630550Z",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1622478343324,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring",
      "location": "global",
      "name": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring",
      "projectId": "j1-gc-integration-dev-v3",
      "shortName": "example-topic-keyring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/global/example-topic-keyring/key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:42.998855757Z",
            "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1622478342998,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring",
      "location": "us",
      "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring",
      "projectId": "j1-gc-integration-dev-v3",
      "shortName": "example-keyring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us/example-keyring/key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:43.452796640Z",
            "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1622478343452,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring",
      "location": "us",
      "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring",
      "projectId": "j1-gc-integration-dev-v3",
      "shortName": "j1-gc-integration-dev-v3-bucket-ring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us/j1-gc-integration-dev-v3-bucket-ring/key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:42.750605992Z",
            "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1622478342750,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring",
      "location": "us",
      "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring",
      "projectId": "j1-gc-integration-dev-v3",
      "shortName": "j1-gc-integration-dev-v3-disk-bucket-ring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us/j1-gc-integration-dev-v3-disk-bucket-ring/key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Vault",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:42.389137569Z",
            "name": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring",
          },
        },
      ],
      "_type": "google_kms_key_ring",
      "createdOn": 1622478342389,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring",
      "location": "us-central1",
      "name": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring",
      "projectId": "j1-gc-integration-dev-v3",
      "shortName": "j1-gc-integration-dev-v3-encrypted-sql-instance-ring",
      "webLink": "https://console.cloud.google.com/security/kms/keyring/manage/us-central1/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Key",
        "CryptoKey",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:54.427526595Z",
            "destroyScheduledDuration": "86400s",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key",
            "primary": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "createTime": "2021-05-31T16:25:54.427526595Z",
              "generateTime": "2021-05-31T16:25:54.427526595Z",
              "name": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key/cryptoKeyVersions/1",
              "protectionLevel": "SOFTWARE",
              "state": "ENABLED",
            },
            "purpose": "ENCRYPT_DECRYPT",
            "versionTemplate": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "protectionLevel": "SOFTWARE",
            },
          },
        },
      ],
      "_type": "google_kms_crypto_key",
      "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "createdOn": 1622478354427,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key",
      "keyUsage": "ENCRYPT_DECRYPT",
      "name": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key",
      "nextRotationTime": undefined,
      "primaryAlgorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "primaryCreateTime": 1622478354427,
      "primaryGenerateTime": 1622478354427,
      "primaryName": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key/cryptoKeyVersions/1",
      "primaryProtectionLevel": "SOFTWARE",
      "primaryState": "ENABLED",
      "protectionLevel": "SOFTWARE",
      "public": false,
      "purpose": "ENCRYPT_DECRYPT",
      "rotationPeriod": undefined,
      "webLink": "https://console.cloud.google.com/security/kms/key/manage/global/example-topic-keyring/projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Key",
        "CryptoKey",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:53.130589171Z",
            "destroyScheduledDuration": "86400s",
            "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key",
            "primary": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "createTime": "2021-05-31T16:25:53.130589171Z",
              "generateTime": "2021-05-31T16:25:53.130589171Z",
              "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key/cryptoKeyVersions/1",
              "protectionLevel": "SOFTWARE",
              "state": "ENABLED",
            },
            "purpose": "ENCRYPT_DECRYPT",
            "versionTemplate": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "protectionLevel": "SOFTWARE",
            },
          },
        },
      ],
      "_type": "google_kms_crypto_key",
      "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "createdOn": 1622478353130,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key",
      "keyUsage": "ENCRYPT_DECRYPT",
      "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key",
      "nextRotationTime": undefined,
      "primaryAlgorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "primaryCreateTime": 1622478353130,
      "primaryGenerateTime": 1622478353130,
      "primaryName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key/cryptoKeyVersions/1",
      "primaryProtectionLevel": "SOFTWARE",
      "primaryState": "ENABLED",
      "protectionLevel": "SOFTWARE",
      "public": false,
      "purpose": "ENCRYPT_DECRYPT",
      "rotationPeriod": undefined,
      "webLink": "https://console.cloud.google.com/security/kms/key/manage/us/example-keyring/projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Key",
        "CryptoKey",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:54.506981906Z",
            "destroyScheduledDuration": "86400s",
            "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key",
            "nextRotationTime": "2022-03-30T16:31:28.155251Z",
            "primary": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "createTime": "2022-03-29T16:31:27.155251548Z",
              "generateTime": "2022-03-29T16:31:27.155251548Z",
              "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key/cryptoKeyVersions/303",
              "protectionLevel": "SOFTWARE",
              "state": "ENABLED",
            },
            "purpose": "ENCRYPT_DECRYPT",
            "rotationPeriod": "86401s",
            "versionTemplate": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "protectionLevel": "SOFTWARE",
            },
          },
        },
      ],
      "_type": "google_kms_crypto_key",
      "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "createdOn": 1622478354506,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key",
      "keyUsage": "ENCRYPT_DECRYPT",
      "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key",
      "nextRotationTime": 1648657888155,
      "primaryAlgorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "primaryCreateTime": 1648571487155,
      "primaryGenerateTime": 1648571487155,
      "primaryName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key/cryptoKeyVersions/303",
      "primaryProtectionLevel": "SOFTWARE",
      "primaryState": "ENABLED",
      "protectionLevel": "SOFTWARE",
      "public": false,
      "purpose": "ENCRYPT_DECRYPT",
      "rotationPeriod": 86401,
      "webLink": "https://console.cloud.google.com/security/kms/key/manage/us/j1-gc-integration-dev-v3-bucket-ring/projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Key",
        "CryptoKey",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:52.740906673Z",
            "destroyScheduledDuration": "86400s",
            "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key",
            "nextRotationTime": "2022-03-30T16:31:26.443268Z",
            "primary": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "createTime": "2022-03-29T16:31:25.443268590Z",
              "generateTime": "2022-03-29T16:31:25.443268590Z",
              "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key/cryptoKeyVersions/303",
              "protectionLevel": "SOFTWARE",
              "state": "ENABLED",
            },
            "purpose": "ENCRYPT_DECRYPT",
            "rotationPeriod": "86401s",
            "versionTemplate": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "protectionLevel": "SOFTWARE",
            },
          },
        },
      ],
      "_type": "google_kms_crypto_key",
      "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "createdOn": 1622478352740,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key",
      "keyUsage": "ENCRYPT_DECRYPT",
      "name": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key",
      "nextRotationTime": 1648657886443,
      "primaryAlgorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "primaryCreateTime": 1648571485443,
      "primaryGenerateTime": 1648571485443,
      "primaryName": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key/cryptoKeyVersions/303",
      "primaryProtectionLevel": "SOFTWARE",
      "primaryState": "ENABLED",
      "protectionLevel": "SOFTWARE",
      "public": false,
      "purpose": "ENCRYPT_DECRYPT",
      "rotationPeriod": 86401,
      "webLink": "https://console.cloud.google.com/security/kms/key/manage/us/j1-gc-integration-dev-v3-disk-bucket-ring/projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Key",
        "CryptoKey",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T16:25:43.794005568Z",
            "destroyScheduledDuration": "86400s",
            "name": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key",
            "nextRotationTime": "2022-03-30T16:31:17.473696Z",
            "primary": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "createTime": "2022-03-29T16:31:16.473696599Z",
              "generateTime": "2022-03-29T16:31:16.473696599Z",
              "name": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key/cryptoKeyVersions/303",
              "protectionLevel": "SOFTWARE",
              "state": "ENABLED",
            },
            "purpose": "ENCRYPT_DECRYPT",
            "rotationPeriod": "86401s",
            "versionTemplate": Object {
              "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
              "protectionLevel": "SOFTWARE",
            },
          },
        },
      ],
      "_type": "google_kms_crypto_key",
      "algorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "createdOn": 1622478343794,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key",
      "keyUsage": "ENCRYPT_DECRYPT",
      "name": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key",
      "nextRotationTime": 1648657877473,
      "primaryAlgorithm": "GOOGLE_SYMMETRIC_ENCRYPTION",
      "primaryCreateTime": 1648571476473,
      "primaryGenerateTime": 1648571476473,
      "primaryName": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key/cryptoKeyVersions/303",
      "primaryProtectionLevel": "SOFTWARE",
      "primaryState": "ENABLED",
      "protectionLevel": "SOFTWARE",
      "public": false,
      "purpose": "ENCRYPT_DECRYPT",
      "rotationPeriod": 86401,
      "webLink": "https://console.cloud.google.com/security/kms/key/manage/us-central1/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Account",
      ],
      "_key": "projects/167984947943",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "createTime": "2021-05-31T15:15:56.125Z",
            "displayName": "j1-gc-integration-dev-v3",
            "etag": "CzUfI2XTWvMJgVGlic9LWA==",
            "name": "projects/167984947943",
            "parent": "folders/306329820365",
            "projectId": "j1-gc-integration-dev-v3",
            "state": "ACTIVE",
            "updateTime": "2021-05-31T15:15:58.148Z",
          },
        },
      ],
      "_type": "google_cloud_project",
      "createdOn": 1622474156125,
      "displayName": "j1-gc-integration-dev-v3",
      "id": "j1-gc-integration-dev-v3",
      "lifecycleState": "ACTIVE",
      "name": "projects/167984947943",
      "parent": "folders/306329820365",
      "projectId": "j1-gc-integration-dev-v3",
      "updatedOn": 1622474158148,
      "webLink": "https://console.cloud.google.com/home/dashboard?project=j1-gc-integration-dev-v3",
    },
    Object {
      "_class": Array [
        "Database",
      ],
      "_key": "https://www.googleapis.com/sql/v1beta4/projects/j1-gc-integration-dev-v3/instances/j1-gc-integration-dev-v3-mysql",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "availableMaintenanceVersions": Array [
              "MYSQL_5_7_36.R20220220.01_08",
            ],
            "backendType": "SECOND_GEN",
            "connectionName": "j1-gc-integration-dev-v3:us-central1:j1-gc-integration-dev-v3-mysql",
            "createTime": "2021-10-28T15:30:44.637Z",
            "databaseInstalledVersion": "MYSQL_5_7_36",
            "databaseVersion": "MYSQL_5_7",
            "etag": "9aff483f746fe938d06ac526f34027495c1081383c770034914108a155f5f92e",
            "gceZone": "us-central1-b",
            "instanceType": "CLOUD_SQL_INSTANCE",
            "ipAddresses": Array [
              Object {
                "ipAddress": "35.226.138.156",
                "type": "PRIMARY",
              },
            ],
            "kind": "sql#instance",
            "name": "j1-gc-integration-dev-v3-mysql",
            "project": "j1-gc-integration-dev-v3",
            "region": "us-central1",
            "selfLink": "https://www.googleapis.com/sql/v1beta4/projects/j1-gc-integration-dev-v3/instances/j1-gc-integration-dev-v3-mysql",
            "serverCaCert": Object {
              "cert": "-----BEGIN CERTIFICATE-----
MIIDfzCCAmegAwIBAgIBADANBgkqhkiG9w0BAQsFADB3MS0wKwYDVQQuEyQ1OTE5
ZDVjZC05MDgyLTRkZjEtYTc2NC1hYzAwZGMyMjg1MjYxIzAhBgNVBAMTGkdvb2ds
ZSBDbG91ZCBTUUwgU2VydmVyIENBMRQwEgYDVQQKEwtHb29nbGUsIEluYzELMAkG
A1UEBhMCVVMwHhcNMjExMDI4MTUzMDQ3WhcNMzExMDI2MTUzMTQ3WjB3MS0wKwYD
VQQuEyQ1OTE5ZDVjZC05MDgyLTRkZjEtYTc2NC1hYzAwZGMyMjg1MjYxIzAhBgNV
BAMTGkdvb2dsZSBDbG91ZCBTUUwgU2VydmVyIENBMRQwEgYDVQQKEwtHb29nbGUs
IEluYzELMAkGA1UEBhMCVVMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIB
AQCQpB9RXSU9PTX2gKJlXrsAkUWwi/r2QPgL7qIMYlbCiWEhrBbN/epXBJQIh882
k2X0oZp1RCEnQyw9OrdnEZ4bxhmPF5nZ/eh0mnXHNRBPV5IZODre4+dE+7ku7Z20
ZtPB96BuEeN7KdMySbBUK20hLmrXlZEsNF3JUls0TDiVTiC7HDpCzwdif1NcQYD/
TMoqzMmNBnwFrO5mbEY4c096xIeOVe/sl/VMTub4Y5FFivCOos4leS7f3cBx59qH
OGzFj7r3pzcLv9GPZxeA/GMvt2chK84a8iO+4LB/a4j4NBRR+Gd8t4imo21jPLl8
wp/b6yLEXCJQOHv6lqjmJvefAgMBAAGjFjAUMBIGA1UdEwEB/wQIMAYBAf8CAQAw
DQYJKoZIhvcNAQELBQADggEBACjtJxZ1/p9TjLVuokjnT+8cyFmcxH9oyLs2WQjB
3hnBDGdkudtfk/3b5sRIoal0Fmtfqyi5KzYQPAN7+7uQbRMqf3ANSUo3RJrJPvek
buWOg99tb1M9IUkntCAkZKTFxY4prytXU0lCV7VFviEpDkOjsetgRyBSnD4xDECh
Esm4B6D87sMECf6RmqCk1oZ5XBa385vymjpGQpLYrMEfT0VgdDd4p71f7mol3ZX1
QMnZ3XAsSPva+g7fdwi/WfvRwSx1H8//CPfuA2EiJtftnvIrD00Oz697njULL7XL
C2MpXJY9ia6ruqjCbxaSXlyeQdn29YJBeCXcqoWLoQZOCQQ=
-----END CERTIFICATE-----",
              "certSerialNumber": "0",
              "commonName": "C=US,O=Google\\\\, Inc,CN=Google Cloud SQL Server CA,dnQualifier=5919d5cd-9082-4df1-a764-ac00dc228526",
              "createTime": "2021-10-28T15:30:47.899Z",
              "expirationTime": "2031-10-26T15:31:47.899Z",
              "instance": "j1-gc-integration-dev-v3-mysql",
              "kind": "sql#sslCert",
              "sha1Fingerprint": "ba5768adab75dbb390fdb542f20f209efcfa98ed",
            },
            "serviceAccountEmailAddress": "p167984947943-0cu0r7@gcp-sa-cloud-sql.iam.gserviceaccount.com",
            "settings": Object {
              "activationPolicy": "ALWAYS",
              "authorizedGaeApplications": Array [],
              "availabilityType": "ZONAL",
              "backupConfiguration": Object {
                "backupRetentionSettings": Object {
                  "retainedBackups": 7,
                  "retentionUnit": "COUNT",
                },
                "binaryLogEnabled": false,
                "enabled": false,
                "kind": "sql#backupConfiguration",
                "startTime": "20:00",
                "transactionLogRetentionDays": 7,
              },
              "dataDiskSizeGb": "10",
              "dataDiskType": "PD_HDD",
              "databaseFlags": Array [
                Object {
                  "name": "cloudsql_iam_authentication",
                  "value": "on",
                },
              ],
              "ipConfiguration": Object {
                "authorizedNetworks": Array [],
                "ipv4Enabled": true,
              },
              "kind": "sql#settings",
              "locationPreference": Object {
                "kind": "sql#locationPreference",
                "zone": "us-central1-b",
              },
              "maintenanceWindow": Object {
                "day": 0,
                "hour": 0,
                "kind": "sql#maintenanceWindow",
              },
              "pricingPlan": "PER_USE",
              "replicationType": "SYNCHRONOUS",
              "settingsVersion": "29",
              "storageAutoResize": false,
              "storageAutoResizeLimit": "0",
              "tier": "db-f1-micro",
            },
            "state": "RUNNABLE",
          },
        },
      ],
      "_type": "google_sql_mysql_instance",
      "authorizedNetworks": Array [],
      "automatedBackupsEnabled": false,
      "connectionName": "j1-gc-integration-dev-v3:us-central1:j1-gc-integration-dev-v3-mysql",
      "createdOn": undefined,
      "displayName": "j1-gc-integration-dev-v3-mysql",
      "encrypted": true,
      "hasPublicIP": true,
      "ipAddresses": Array [
        "35.226.138.156",
      ],
      "kmsKeyName": undefined,
      "localInfile": undefined,
      "location": "j1-gc-integration-dev-v3:us-central1:j1-gc-integration-dev-v3-mysql",
      "name": "j1-gc-integration-dev-v3-mysql",
      "outgoingIpAddresses": undefined,
      "primaryIpAddresses": Array [
        "35.226.138.156",
      ],
      "privateIpAddresses": undefined,
      "requireSSL": undefined,
      "skipShowDatabase": undefined,
    },
  ],
  "collectedRelationships": Array [
    Object {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring|has|projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/keyRings/example-topic-keyring/cryptoKeys/example-key",
      "_type": "google_kms_key_ring_has_crypto_key",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring",
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring|has|projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/example-keyring/cryptoKeys/cmek_bigquery_crypto_key",
      "_type": "google_kms_key_ring_has_crypto_key",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring",
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring|has|projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-bucket-key",
      "_type": "google_kms_key_ring_has_crypto_key",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring",
      "_key": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring|has|projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/us/keyRings/j1-gc-integration-dev-v3-disk-bucket-ring/cryptoKeys/j1-gc-integration-dev-v3-disk-bucket-key",
      "_type": "google_kms_key_ring_has_crypto_key",
      "displayName": "HAS",
    },
    Object {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring",
      "_key": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring|has|projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/us-central1/keyRings/j1-gc-integration-dev-v3-encrypted-sql-instance-ring/cryptoKeys/j1-gc-integration-dev-v3-encrypted-sql-instance-key",
      "_type": "google_kms_key_ring_has_crypto_key",
      "displayName": "HAS",
    },
  ],
  "encounteredTypes": Array [
    "google_kms_key_ring",
    "google_kms_crypto_key",
    "google_kms_key_ring_has_crypto_key",
    "google_cloud_project",
    "google_sql_mysql_instance",
  ],
  "numCollectedEntities": 12,
  "numCollectedRelationships": 5,
}
`;

exports[`#fetchSQLInstances should collect data 1`] = `
{
  "collectedEntities": [
    {
      "_class": [
        "Account",
      ],
      "_key": "projects/167984947943",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2021-05-31T15:15:56.125Z",
            "displayName": "j1-gc-integration-dev-v3",
            "etag": "CzUfI2XTWvMJgVGlic9LWA==",
            "name": "projects/167984947943",
            "parent": "folders/306329820365",
            "projectId": "j1-gc-integration-dev-v3",
            "state": "ACTIVE",
            "updateTime": "2021-05-31T15:15:58.148Z",
          },
        },
      ],
      "_type": "google_cloud_project",
      "createdOn": 1622474156125,
      "displayName": "j1-gc-integration-dev-v3",
      "id": "j1-gc-integration-dev-v3",
      "lifecycleState": "ACTIVE",
      "name": "projects/167984947943",
      "parent": "folders/306329820365",
      "projectId": "j1-gc-integration-dev-v3",
      "updatedOn": 1622474158148,
      "webLink": "https://console.cloud.google.com/home/dashboard?project=j1-gc-integration-dev-v3",
    },
    {
      "_class": [
        "Database",
      ],
      "_key": "https://www.googleapis.com/sql/v1beta4/projects/j1-gc-integration-dev-v3/instances/example-sql-server",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "backendType": "SECOND_GEN",
            "connectionName": "j1-gc-integration-dev-v3:us-central1:example-sql-server",
            "createTime": "2021-09-08T14:41:12.624Z",
            "databaseVersion": "SQLSERVER_2017_STANDARD",
            "etag": "0c3a25130f20382b59154176c134d3ae0ca6c2c4c20430cd3cdfc516ef368e9f",
            "failoverReplica": {
              "available": true,
            },
            "gceZone": "us-central1-f",
            "instanceType": "CLOUD_SQL_INSTANCE",
            "ipAddresses": [
              {
                "ipAddress": "35.239.209.196",
                "type": "PRIMARY",
              },
            ],
            "kind": "sql#instance",
            "name": "example-sql-server",
            "project": "j1-gc-integration-dev-v3",
            "region": "us-central1",
            "secondaryGceZone": "us-central1-c",
            "selfLink": "https://www.googleapis.com/sql/v1beta4/projects/j1-gc-integration-dev-v3/instances/example-sql-server",
            "serverCaCert": {
              "cert": "-----BEGIN CERTIFICATE-----
MIIDfzCCAmegAwIBAgIBADANBgkqhkiG9w0BAQsFADB3MS0wKwYDVQQuEyRjODcz
MTU4MC0yNDUwLTQ2OTItOGMzNC1jM2E3OTU5YzY4MTQxIzAhBgNVBAMTGkdvb2ds
ZSBDbG91ZCBTUUwgU2VydmVyIENBMRQwEgYDVQQKEwtHb29nbGUsIEluYzELMAkG
A1UEBhMCVVMwHhcNMjEwOTA4MTQ0MzQ4WhcNMzEwOTA2MTQ0NDQ4WjB3MS0wKwYD
VQQuEyRjODczMTU4MC0yNDUwLTQ2OTItOGMzNC1jM2E3OTU5YzY4MTQxIzAhBgNV
BAMTGkdvb2dsZSBDbG91ZCBTUUwgU2VydmVyIENBMRQwEgYDVQQKEwtHb29nbGUs
IEluYzELMAkGA1UEBhMCVVMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIB
AQCPvEI1371UTboqIhcezwW+qbGT//RmF193ZLxhiRsL2g+oOLuxK6iJkoKgK9sV
W4LcwqzLqM6Cp2iHLV1ZwBGFng5s2ksvs3Vko6epetI5dmgBhIzXt/K2ok10ntWN
c/F1hXVTc+5ZUdvxhf+usG3Q+HiUBez/cUkyhjatAhEzjdABf1m9dOWcU+Uaf8k/
GDBe1ap3xwC5BJan5HtJTjabrT+j7mJwfBcloKiGsQ2rUyPzzKyosVmUAjclhmlN
lbK276AaLQqfC6oSlQ9oLbKJrzvFP00P/LAKUyF3zoqm6lXhqTwOkRYpPCcu25L1
EY/FzHQM8NERYdvSqbLuVNT5AgMBAAGjFjAUMBIGA1UdEwEB/wQIMAYBAf8CAQAw
DQYJKoZIhvcNAQELBQADggEBABdn68cy3ObP2uwMKYzQEuV4xg6hLUflMgKfh2MK
rhz3o5ofjm+Z/kJBmeS9qiv3ZqfNpgYtBm1/M74cWgwPid30drbXF9Fq40nDoSX/
EN9uufWSREJm+XZf4idaNwusKiReBtNjqb8Ww8afp2bdCUmRsC14j87mRa2GafpM
Xr+8pPkhLSyCAvtge3SKNc5kKpfJ8S/hsv37XoBGaEkKb/ohID6p52mmD7AQWq+8
qdzcmzbwUVVMhYrZok/NA12RicVEwrRZqBg6XUFWuw8L/14VMeBx3Tr4lZbLSaiS
kShq2N8NAKLPdgghXgkLrDfTixqqFsPLrUwerBbsPdqXjC0=
-----END CERTIFICATE-----",
              "certSerialNumber": "0",
              "commonName": "C=US,O=Google\\, Inc,CN=Google Cloud SQL Server CA,dnQualifier=c8731580-2450-4692-8c34-c3a7959c6814",
              "createTime": "2021-09-08T14:43:48.697Z",
              "expirationTime": "2031-09-06T14:44:48.697Z",
              "instance": "example-sql-server",
              "kind": "sql#sslCert",
              "sha1Fingerprint": "70ca9acc56140ca73c55e662607201decac979fb",
            },
            "serviceAccountEmailAddress": "p167984947943-ds9ayw@gcp-sa-cloud-sql.iam.gserviceaccount.com",
            "settings": {
              "activationPolicy": "ALWAYS",
              "activeDirectoryConfig": {
                "kind": "sql#activeDirectoryConfig",
              },
              "authorizedGaeApplications": [],
              "availabilityType": "REGIONAL",
              "backupConfiguration": {
                "backupRetentionSettings": {
                  "retainedBackups": 7,
                  "retentionUnit": "COUNT",
                },
                "enabled": true,
                "kind": "sql#backupConfiguration",
                "location": "us",
                "startTime": "19:00",
                "transactionLogRetentionDays": 7,
              },
              "collation": "SQL_Latin1_General_CP1_CI_AS",
              "dataDiskSizeGb": "100",
              "dataDiskType": "PD_SSD",
              "databaseFlags": [
                {
                  "name": "user options",
                  "value": "22",
                },
              ],
              "ipConfiguration": {
                "authorizedNetworks": [],
                "ipv4Enabled": true,
              },
              "kind": "sql#settings",
              "locationPreference": {
                "kind": "sql#locationPreference",
                "zone": "us-central1-f",
              },
              "maintenanceWindow": {
                "day": 0,
                "hour": 0,
                "kind": "sql#maintenanceWindow",
              },
              "pricingPlan": "PER_USE",
              "replicationType": "SYNCHRONOUS",
              "settingsVersion": "3",
              "storageAutoResize": true,
              "storageAutoResizeLimit": "0",
              "tier": "db-custom-4-26624",
            },
            "state": "RUNNABLE",
          },
        },
      ],
      "_type": "google_sql_sql_server_instance",
      "authorizedNetworks": [],
      "automatedBackupsEnabled": true,
      "connectionName": "j1-gc-integration-dev-v3:us-central1:example-sql-server",
      "containedDatabaseAuthentication": undefined,
      "createdOn": undefined,
      "crossDatabaseOwnershipChaining": undefined,
      "displayName": "example-sql-server",
      "encrypted": true,
      "externalScriptsEnabled": undefined,
      "hasPublicIP": true,
      "ipAddresses": [
        "35.239.209.196",
      ],
      "kmsKeyName": undefined,
      "location": "j1-gc-integration-dev-v3:us-central1:example-sql-server",
      "name": "example-sql-server",
      "outgoingIpAddresses": undefined,
      "primaryIpAddresses": [
        "35.239.209.196",
      ],
      "privateIpAddresses": undefined,
      "remoteAccess": undefined,
      "requireSSL": undefined,
      "traceFlag": undefined,
      "userConnections": undefined,
      "userOptions": 22,
    },
  ],
  "collectedRelationships": [],
  "encounteredTypes": [
    "google_cloud_project",
    "google_sql_sql_server_instance",
  ],
  "numCollectedEntities": 2,
  "numCollectedRelationships": 0,
}
`;
