// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`networkAnalyzer#build-network-intelligence-center-has-network-analyzer-connectivity-test-relationship should collect data 1`] = `
{
  "collectedEntities": [
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/gke-cluster",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-17T11:20:44.490270052Z",
            "destination": {
              "gkeMasterCluster": "projects/j1-gc-integration-dev-v3/locations/us-central1/clusters/autopilot-cluster-2",
              "ipAddress": "10.128.0.31",
              "port": 443,
            },
            "displayName": "gke-cluster",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/gke-cluster",
            "probingDetails": {
              "result": "UNREACHABLE",
              "sentProbeCount": 50,
              "verifyTime": "2024-05-17T11:20:58.813960Z",
            },
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "UNREACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "10.128.0.31",
                    "destinationNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "destinationPort": 443,
                    "protocol": "TCP",
                    "sourceIp": "10.128.0.21",
                    "sourceNetworkUri": "projects/gke-prod-us-central1-1e5e/global/networks/gke-3ba4079f9e57490cae5b-b4f8-1a74-net",
                    "sourcePort": 52231,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "description": "Initial state: packet originating from a Google Kubernetes Engine control plane.",
                      "gkeMaster": {
                        "clusterNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "clusterUri": "projects/j1-gc-integration-dev-v3/locations/us-central1/clusters/autopilot-cluster-1",
                        "externalIp": "34.72.61.38",
                        "internalIp": "10.128.0.21",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_GKE_MASTER",
                    },
                    {
                      "description": "Final state: packet dropped due to no route from a GKE cluster control plane to a destination network.",
                      "drop": {
                        "cause": "GKE_CONTROL_PLANE_NO_ROUTE",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/locations/us-central1/clusters/autopilot-cluster-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DROP",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-17T11:21:08.554491724Z",
            },
            "source": {
              "gkeMasterCluster": "projects/j1-gc-integration-dev-v3/locations/us-central1/clusters/autopilot-cluster-1",
            },
            "updateTime": "2024-05-17T11:21:08.626001345Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "gke-cluster",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": undefined,
      "dstInstance": undefined,
      "dstNetwork": undefined,
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/gke-cluster",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": undefined,
      "srcNetwork": undefined,
      "summary": "UNREACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-ooi",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-17T04:22:33.396424453Z",
            "destination": {
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
              "port": 80,
            },
            "displayName": "test-ooi",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-ooi",
            "probingDetails": {
              "probingLatency": {
                "latencyPercentiles": [
                  {
                    "latencyMicros": "92",
                    "percent": 50,
                  },
                  {
                    "latencyMicros": "114",
                    "percent": 95,
                  },
                ],
              },
              "result": "REACHABLE",
              "sentProbeCount": 50,
              "successfulProbeCount": 50,
              "verifyTime": "2024-05-17T04:22:34.406412Z",
            },
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "REACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "34.172.130.250",
                    "destinationNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourceIp": "34.71.254.170",
                    "sourceNetworkUri": "projects/z426ad7c17543d261p-tp/global/networks/default-with-directpath",
                    "sourcePort": 61503,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "cloudSqlInstance": {
                        "displayName": "demo-mysql-instance",
                        "externalIp": "34.71.254.170",
                        "region": "us-central1",
                        "uri": "projects/j1-gc-integration-dev-v3/instances/demo-mysql-instance",
                      },
                      "description": "Initial state: packet originating from a Cloud SQL instance.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_CLOUD_SQL_INSTANCE",
                    },
                    {
                      "description": "Transition state: packet header translated due to external to internal NAT.",
                      "nat": {
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "newDestinationIp": "10.128.15.223",
                        "newDestinationPort": 80,
                        "newSourceIp": "34.70.253.177",
                        "newSourcePort": 61503,
                        "oldDestinationIp": "34.172.130.250",
                        "oldDestinationPort": 80,
                        "oldSourceIp": "34.70.253.177",
                        "oldSourcePort": 61503,
                        "protocol": "TCP",
                        "type": "EXTERNAL_TO_INTERNAL",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "NAT",
                    },
                    {
                      "description": "Forwarding state: arriving at a Compute Engine instance.",
                      "instance": {
                        "displayName": "instance-1",
                        "externalIp": "34.172.130.250",
                        "interface": "nic0",
                        "internalIp": "10.128.15.223",
                        "networkTags": [
                          "http-server",
                          "https-server",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ARRIVE_AT_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify INGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "INGRESS",
                        "displayName": "default-allow-http",
                        "firewallRuleType": "VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 1000,
                        "targetTags": [
                          "http-server",
                        ],
                        "uri": "projects/j1-gc-integration-dev-v3/global/firewalls/default-allow-http",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_INGRESS_FIREWALL_RULE",
                    },
                    {
                      "deliver": {
                        "ipAddress": "10.128.15.223",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                        "target": "INSTANCE",
                      },
                      "description": "Final state: packet delivered to instance.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DELIVER",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-17T04:22:44.108611974Z",
            },
            "source": {
              "cloudSqlInstance": "projects/j1-gc-integration-dev-v3/instances/demo-mysql-instance",
            },
            "updateTime": "2024-05-17T04:22:44.161919355Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "test-ooi",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": undefined,
      "dstInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
      "dstNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-ooi",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": "projects/j1-gc-integration-dev-v3/instances/demo-mysql-instance",
      "srcForwardingRule": undefined,
      "srcInstance": undefined,
      "srcNetwork": undefined,
      "summary": "REACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-conn-1",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-02T08:04:28.758151444Z",
            "destination": {
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
              "port": 80,
            },
            "displayName": "test-conn-1",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-conn-1",
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "UNREACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "10.128.15.223",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourcePort": 51922,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "causesDrop": true,
                      "cloudRunRevision": {
                        "displayName": "hello-image-test-00001-vov",
                        "location": "us-central1",
                        "serviceUri": "projects/j1-gc-integration-dev-v3/locations/us-central1/services/hello-image-test",
                        "uri": "projects/j1-gc-integration-dev-v3/locations/us-central1/revisions/hello-image-test-00001-vov",
                      },
                      "description": "Initial state: packet originating from a Cloud Run revision.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_CLOUD_RUN_REVISION",
                    },
                    {
                      "description": "Final state: packet dropped due to VPC connector not set.",
                      "drop": {
                        "cause": "VPC_CONNECTOR_NOT_SET",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/locations/us-central1/revisions/hello-image-test-00001-vov",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DROP",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-02T08:04:29.373575479Z",
            },
            "source": {
              "cloudRunRevision": {
                "uri": "projects/j1-gc-integration-dev-v3/locations/us-central1/revisions/hello-image-test-00001-vov",
              },
            },
            "updateTime": "2024-05-02T08:04:29.420599613Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "test-conn-1",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": undefined,
      "dstInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
      "dstNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-conn-1",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": undefined,
      "srcNetwork": undefined,
      "summary": "UNREACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-connection-02",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-02T07:54:19.560269950Z",
            "destination": {
              "ipAddress": "10.32.0.0",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/test-network",
              "port": 80,
              "projectId": "j1-gc-integration-dev-v3",
            },
            "displayName": "test-connection-02",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-connection-02",
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "UNDETERMINED",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "10.32.0.0",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourceIp": "10.28.0.0",
                    "sourcePort": 61378,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "abort": {
                        "cause": "NO_SOURCE_LOCATION",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/global/networks/test-network",
                      },
                      "description": "Final state: analysis is aborted due to no valid source location found.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ABORT",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-02T07:54:20.398050468Z",
            },
            "source": {
              "ipAddress": "10.28.0.0",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/test-network",
              "projectId": "j1-gc-integration-dev-v3",
            },
            "updateTime": "2024-05-02T07:54:20.447853142Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "test-connection-02",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": undefined,
      "dstInstance": undefined,
      "dstNetwork": "projects/j1-gc-integration-dev-v3/global/networks/test-network",
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-connection-02",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": undefined,
      "srcNetwork": "projects/j1-gc-integration-dev-v3/global/networks/test-network",
      "summary": "UNDETERMINED",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/connectivity-test-for-vpc-network",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-02T05:58:05.787202474Z",
            "destination": {
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
              "ipAddress": "10.128.15.219",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
              "port": 80,
            },
            "displayName": "connectivity-test-for-vpc-network",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/connectivity-test-for-vpc-network",
            "probingDetails": {
              "probingLatency": {
                "latencyPercentiles": [
                  {
                    "latencyMicros": "39",
                    "percent": 50,
                  },
                  {
                    "latencyMicros": "61",
                    "percent": 95,
                  },
                ],
              },
              "result": "REACHABLE",
              "sentProbeCount": 50,
              "successfulProbeCount": 50,
              "verifyTime": "2024-05-02T05:58:06.608601Z",
            },
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "REACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "10.128.15.219",
                    "destinationNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourceIp": "10.128.15.223",
                    "sourceNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "sourcePort": 56309,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "description": "Initial state: packet originating from a Compute Engine instance.",
                      "instance": {
                        "displayName": "instance-1",
                        "externalIp": "34.172.130.250",
                        "interface": "nic0",
                        "internalIp": "10.128.15.223",
                        "networkTags": [
                          "http-server",
                          "https-server",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify EGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "EGRESS",
                        "displayName": "default-allow-egress",
                        "firewallRuleType": "IMPLIED_VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 65535,
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_EGRESS_FIREWALL_RULE",
                    },
                    {
                      "description": "Config checking state: verify route.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "route": {
                        "destIpRange": "10.128.0.0/20",
                        "displayName": "default-route-3983b63c88b8bd67",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "nextHop": "network gateway",
                        "nextHopType": "NEXT_HOP_NETWORK",
                        "routeScope": "NETWORK",
                        "routeType": "SUBNET",
                        "uri": "projects/j1-gc-integration-dev-v3/global/routes/default-route-3983b63c88b8bd67",
                      },
                      "state": "APPLY_ROUTE",
                    },
                    {
                      "description": "Forwarding state: arriving at a Compute Engine instance.",
                      "instance": {
                        "displayName": "sonarqube",
                        "externalIp": "34.171.196.173",
                        "interface": "nic0",
                        "internalIp": "10.128.15.219",
                        "networkTags": [
                          "http-server",
                          "https-server",
                          "sonarqube",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ARRIVE_AT_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify INGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "INGRESS",
                        "displayName": "default-allow-http",
                        "firewallRuleType": "VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 1000,
                        "targetTags": [
                          "http-server",
                        ],
                        "uri": "projects/j1-gc-integration-dev-v3/global/firewalls/default-allow-http",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_INGRESS_FIREWALL_RULE",
                    },
                    {
                      "deliver": {
                        "ipAddress": "10.128.15.219",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
                        "target": "INSTANCE",
                      },
                      "description": "Final state: packet delivered to instance.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DELIVER",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-02T05:58:15.757249217Z",
            },
            "source": {
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
              "ipAddress": "10.128.15.223",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
            },
            "updateTime": "2024-05-02T05:58:15.818494538Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "connectivity-test-for-vpc-network",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": undefined,
      "dstInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
      "dstNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/connectivity-test-for-vpc-network",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
      "srcNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "summary": "REACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/bharat-001",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-17T06:20:02.384083921Z",
            "destination": {
              "cloudSqlInstance": "projects/j1-gc-integration-dev-v3/instances/demo-mysql-instance",
              "ipAddress": "34.71.254.170",
              "port": 80,
            },
            "displayName": "bharat-001",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/bharat-001",
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "REACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "34.71.254.170",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourcePort": 52825,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "appEngineVersion": {
                        "displayName": "20220316t115343",
                        "environment": "standard",
                        "runtime": "nodejs14",
                        "uri": "apps/j1-gc-integration-dev-v3/services/default/versions/20220316t115343",
                      },
                      "description": "Initial state: packet originating from an App Engine version.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_APP_ENGINE_VERSION",
                    },
                    {
                      "deliver": {
                        "target": "INTERNET",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DELIVER",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-17T06:20:03.031787851Z",
            },
            "source": {
              "appEngineVersion": {
                "uri": "apps/j1-gc-integration-dev-v3/services/default/versions/20220316t115343",
              },
            },
            "updateTime": "2024-05-17T06:20:03.082439194Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "bharat-001",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": "projects/j1-gc-integration-dev-v3/instances/demo-mysql-instance",
      "dstForwardingRule": undefined,
      "dstInstance": undefined,
      "dstNetwork": undefined,
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/bharat-001",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": "apps/j1-gc-integration-dev-v3/services/default/versions/20220316t115343",
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": undefined,
      "srcNetwork": undefined,
      "summary": "REACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/cloud-run",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-17T07:48:01.198338383Z",
            "destination": {
              "cloudSqlInstance": "projects/j1-gc-integration-dev-v3/instances/demo-mysql-instance",
              "ipAddress": "34.71.254.170",
              "port": 80,
            },
            "displayName": "cloud-run",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/cloud-run",
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "REACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "34.71.254.170",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourcePort": 63111,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "cloudRunRevision": {
                        "displayName": "cloudrun-srv-z2f5r",
                        "location": "us-central1",
                        "serviceUri": "projects/j1-gc-integration-dev-v3/locations/us-central1/services/cloudrun-srv",
                        "uri": "projects/j1-gc-integration-dev-v3/locations/us-central1/revisions/cloudrun-srv-z2f5r",
                      },
                      "description": "Initial state: packet originating from a Cloud Run revision.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_CLOUD_RUN_REVISION",
                    },
                    {
                      "deliver": {
                        "target": "INTERNET",
                      },
                      "description": "Final state: packet delivered to Internet.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DELIVER",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-17T07:48:01.889058033Z",
            },
            "source": {
              "cloudRunRevision": {
                "uri": "projects/j1-gc-integration-dev-v3/locations/us-central1/revisions/cloudrun-srv-z2f5r",
              },
            },
            "updateTime": "2024-05-17T07:48:01.938046182Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "cloud-run",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": "projects/j1-gc-integration-dev-v3/instances/demo-mysql-instance",
      "dstForwardingRule": undefined,
      "dstInstance": undefined,
      "dstNetwork": undefined,
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/cloud-run",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": undefined,
      "srcNetwork": undefined,
      "summary": "REACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/rule",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-16T07:18:14.983397777Z",
            "destination": {
              "forwardingRule": "projects/j1-gc-integration-dev-v3/regions/us-central1/forwardingRules/a2a38cc1a8dda4b22b59c382dd65b5d9",
              "forwardingRuleTarget": "LOAD_BALANCER",
              "ipAddress": "34.70.55.90",
              "loadBalancerId": "a2a38cc1a8dda4b22b59c382dd65b5d9",
              "loadBalancerType": "LEGACY_NETWORK_LOAD_BALANCER",
              "port": 80,
            },
            "displayName": "rule",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/rule",
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "UNDETERMINED",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "34.70.55.90",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourceIp": "10.128.15.223",
                    "sourceNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "sourcePort": 58730,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "description": "Initial state: packet originating from a Compute Engine instance.",
                      "instance": {
                        "displayName": "instance-1",
                        "externalIp": "34.172.130.250",
                        "interface": "nic0",
                        "internalIp": "10.128.15.223",
                        "networkTags": [
                          "http-server",
                          "https-server",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify EGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "EGRESS",
                        "displayName": "default-allow-egress",
                        "firewallRuleType": "IMPLIED_VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 65535,
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_EGRESS_FIREWALL_RULE",
                    },
                    {
                      "description": "Config checking state: verify route.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "route": {
                        "destIpRange": "0.0.0.0/0",
                        "displayName": "default-route-3da5042086b48377",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "nextHop": "internet gateway",
                        "nextHopType": "NEXT_HOP_INTERNET_GATEWAY",
                        "priority": 1000,
                        "routeScope": "NETWORK",
                        "routeType": "STATIC",
                        "uri": "projects/j1-gc-integration-dev-v3/global/routes/default-route-3da5042086b48377",
                      },
                      "state": "APPLY_ROUTE",
                    },
                    {
                      "description": "Transition state: packet header translated due to internal to external NAT.",
                      "nat": {
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "newDestinationIp": "34.70.55.90",
                        "newDestinationPort": 80,
                        "newSourceIp": "34.172.130.250",
                        "newSourcePort": 58730,
                        "oldDestinationIp": "34.70.55.90",
                        "oldDestinationPort": 80,
                        "oldSourceIp": "10.128.15.223",
                        "oldSourcePort": 58730,
                        "protocol": "TCP",
                        "type": "INTERNAL_TO_EXTERNAL",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "NAT",
                    },
                    {
                      "description": "Config checking state: match forwarding rule.",
                      "forwardingRule": {
                        "displayName": "a2a38cc1a8dda4b22b59c382dd65b5d9",
                        "matchedPortRange": "80-61613",
                        "matchedProtocol": "TCP",
                        "target": "target pool",
                        "uri": "projects/j1-gc-integration-dev-v3/regions/us-central1/forwardingRules/a2a38cc1a8dda4b22b59c382dd65b5d9",
                        "vip": "34.70.55.90",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_FORWARDING_RULE",
                    },
                    {
                      "abort": {
                        "cause": "RESOURCE_CONFIG_NOT_FOUND",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/zones/us-central1-c/instances/gke-j1-cloudbees-cdro-default-pool-67932428-g988",
                      },
                      "description": "Final state: analysis is aborted due to failure on resolving load balancer backend resource.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ABORT",
                    },
                  ],
                },
                {
                  "endpointInfo": {
                    "destinationIp": "34.70.55.90",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourceIp": "10.128.15.223",
                    "sourceNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "sourcePort": 58730,
                  },
                  "forwardTraceId": 2,
                  "steps": [
                    {
                      "description": "Initial state: packet originating from a Compute Engine instance.",
                      "instance": {
                        "displayName": "instance-1",
                        "externalIp": "34.172.130.250",
                        "interface": "nic0",
                        "internalIp": "10.128.15.223",
                        "networkTags": [
                          "http-server",
                          "https-server",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify EGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "EGRESS",
                        "displayName": "default-allow-egress",
                        "firewallRuleType": "IMPLIED_VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 65535,
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_EGRESS_FIREWALL_RULE",
                    },
                    {
                      "description": "Config checking state: verify route.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "route": {
                        "destIpRange": "0.0.0.0/0",
                        "displayName": "default-route-3da5042086b48377",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "nextHop": "internet gateway",
                        "nextHopType": "NEXT_HOP_INTERNET_GATEWAY",
                        "priority": 1000,
                        "routeScope": "NETWORK",
                        "routeType": "STATIC",
                        "uri": "projects/j1-gc-integration-dev-v3/global/routes/default-route-3da5042086b48377",
                      },
                      "state": "APPLY_ROUTE",
                    },
                    {
                      "description": "Transition state: packet header translated due to internal to external NAT.",
                      "nat": {
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "newDestinationIp": "34.70.55.90",
                        "newDestinationPort": 80,
                        "newSourceIp": "34.172.130.250",
                        "newSourcePort": 58730,
                        "oldDestinationIp": "34.70.55.90",
                        "oldDestinationPort": 80,
                        "oldSourceIp": "10.128.15.223",
                        "oldSourcePort": 58730,
                        "protocol": "TCP",
                        "type": "INTERNAL_TO_EXTERNAL",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "NAT",
                    },
                    {
                      "description": "Config checking state: match forwarding rule.",
                      "forwardingRule": {
                        "displayName": "a2a38cc1a8dda4b22b59c382dd65b5d9",
                        "matchedPortRange": "80-61613",
                        "matchedProtocol": "TCP",
                        "target": "target pool",
                        "uri": "projects/j1-gc-integration-dev-v3/regions/us-central1/forwardingRules/a2a38cc1a8dda4b22b59c382dd65b5d9",
                        "vip": "34.70.55.90",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_FORWARDING_RULE",
                    },
                    {
                      "abort": {
                        "cause": "RESOURCE_CONFIG_NOT_FOUND",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/zones/us-central1-c/instances/gke-j1-cloudbees-cdro-default-pool-67932428-e450",
                      },
                      "description": "Final state: analysis is aborted due to failure on resolving load balancer backend resource.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ABORT",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-16T07:18:21.585650013Z",
            },
            "source": {
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
            },
            "updateTime": "2024-05-16T07:18:21.633216197Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "rule",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": "projects/j1-gc-integration-dev-v3/regions/us-central1/forwardingRules/a2a38cc1a8dda4b22b59c382dd65b5d9",
      "dstInstance": undefined,
      "dstNetwork": undefined,
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/rule",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
      "srcNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "summary": "UNDETERMINED",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/load-balancer-01",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-17T10:45:07.096365086Z",
            "destination": {
              "forwardingRule": "projects/j1-gc-integration-dev-v3/global/forwardingRules/delete",
              "forwardingRuleTarget": "LOAD_BALANCER",
              "ipAddress": "34.120.21.175",
              "loadBalancerId": "delete",
              "loadBalancerType": "HTTPS_ADVANCED_LOAD_BALANCER",
              "port": 8080,
            },
            "displayName": "load-balancer-01",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/load-balancer-01",
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "UNREACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "34.120.21.175",
                    "destinationPort": 8080,
                    "protocol": "TCP",
                    "sourceIp": "10.128.15.223",
                    "sourceNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "sourcePort": 60924,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "description": "Initial state: packet originating from a Compute Engine instance.",
                      "instance": {
                        "displayName": "instance-1",
                        "externalIp": "34.172.130.250",
                        "interface": "nic0",
                        "internalIp": "10.128.15.223",
                        "networkTags": [
                          "http-server",
                          "https-server",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify EGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "EGRESS",
                        "displayName": "default-allow-egress",
                        "firewallRuleType": "IMPLIED_VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 65535,
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_EGRESS_FIREWALL_RULE",
                    },
                    {
                      "description": "Config checking state: verify route.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "route": {
                        "destIpRange": "0.0.0.0/0",
                        "displayName": "default-route-3da5042086b48377",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "nextHop": "internet gateway",
                        "nextHopType": "NEXT_HOP_INTERNET_GATEWAY",
                        "priority": 1000,
                        "routeScope": "NETWORK",
                        "routeType": "STATIC",
                        "uri": "projects/j1-gc-integration-dev-v3/global/routes/default-route-3da5042086b48377",
                      },
                      "state": "APPLY_ROUTE",
                    },
                    {
                      "description": "Transition state: packet header translated due to internal to external NAT.",
                      "nat": {
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "newDestinationIp": "34.120.21.175",
                        "newDestinationPort": 8080,
                        "newSourceIp": "34.172.130.250",
                        "newSourcePort": 60924,
                        "oldDestinationIp": "34.120.21.175",
                        "oldDestinationPort": 8080,
                        "oldSourceIp": "10.128.15.223",
                        "oldSourcePort": 60924,
                        "protocol": "TCP",
                        "type": "INTERNAL_TO_EXTERNAL",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "NAT",
                    },
                    {
                      "causesDrop": true,
                      "description": "Config checking state: match forwarding rule.",
                      "forwardingRule": {
                        "displayName": "delete",
                        "matchedProtocol": "TCP",
                        "target": "HTTP proxy",
                        "uri": "projects/j1-gc-integration-dev-v3/global/forwardingRules/delete",
                        "vip": "34.120.21.175",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_FORWARDING_RULE",
                    },
                    {
                      "description": "Final state: packet dropped due to packet port and protocol do not match forwarding rule port and protocol.",
                      "drop": {
                        "cause": "FORWARDING_RULE_MISMATCH",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/global/forwardingRules/delete",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DROP",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-17T10:45:07.827343422Z",
            },
            "source": {
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
              "ipAddress": "10.128.15.223",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
            },
            "updateTime": "2024-05-17T10:45:07.878127466Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "load-balancer-01",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": "projects/j1-gc-integration-dev-v3/global/forwardingRules/delete",
      "dstInstance": undefined,
      "dstNetwork": undefined,
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/load-balancer-01",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
      "srcNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "summary": "UNREACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/demo-test-metron",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-04-23T07:00:31.509683590Z",
            "destination": {
              "appEngineVersion": {},
              "cloudFunction": {},
              "cloudRunRevision": {},
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
              "ipAddress": "10.128.15.219",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
              "port": 80,
            },
            "displayName": "demo-test-metron",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/demo-test-metron",
            "probingDetails": {
              "probingLatency": {
                "latencyPercentiles": [
                  {
                    "latencyMicros": "33",
                    "percent": 50,
                  },
                  {
                    "latencyMicros": "64",
                    "percent": 95,
                  },
                ],
              },
              "result": "REACHABLE",
              "sentProbeCount": 50,
              "successfulProbeCount": 50,
              "verifyTime": "2024-04-30T09:54:15.577604Z",
            },
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "REACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "10.128.15.219",
                    "destinationNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourceIp": "10.128.15.223",
                    "sourceNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "sourcePort": 52227,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "description": "Initial state: packet originating from a Compute Engine instance.",
                      "instance": {
                        "displayName": "instance-1",
                        "externalIp": "34.172.130.250",
                        "interface": "nic0",
                        "internalIp": "10.128.15.223",
                        "networkTags": [
                          "http-server",
                          "https-server",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify EGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "EGRESS",
                        "displayName": "default-allow-egress",
                        "firewallRuleType": "IMPLIED_VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 65535,
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_EGRESS_FIREWALL_RULE",
                    },
                    {
                      "description": "Config checking state: verify route.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "route": {
                        "destIpRange": "10.128.0.0/20",
                        "displayName": "default-route-3983b63c88b8bd67",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "nextHop": "network gateway",
                        "nextHopType": "NEXT_HOP_NETWORK",
                        "routeScope": "NETWORK",
                        "routeType": "SUBNET",
                        "uri": "projects/j1-gc-integration-dev-v3/global/routes/default-route-3983b63c88b8bd67",
                      },
                      "state": "APPLY_ROUTE",
                    },
                    {
                      "description": "Forwarding state: arriving at a Compute Engine instance.",
                      "instance": {
                        "displayName": "sonarqube",
                        "externalIp": "34.171.196.173",
                        "interface": "nic0",
                        "internalIp": "10.128.15.219",
                        "networkTags": [
                          "http-server",
                          "https-server",
                          "sonarqube",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ARRIVE_AT_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify INGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "INGRESS",
                        "displayName": "default-allow-http",
                        "firewallRuleType": "VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 1000,
                        "targetTags": [
                          "http-server",
                        ],
                        "uri": "projects/j1-gc-integration-dev-v3/global/firewalls/default-allow-http",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_INGRESS_FIREWALL_RULE",
                    },
                    {
                      "deliver": {
                        "ipAddress": "10.128.15.219",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
                        "target": "INSTANCE",
                      },
                      "description": "Final state: packet delivered to instance.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DELIVER",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-04-30T09:54:24.761726320Z",
            },
            "source": {
              "appEngineVersion": {},
              "cloudFunction": {},
              "cloudRunRevision": {},
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
              "ipAddress": "10.128.15.223",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
            },
            "updateTime": "2024-04-30T09:54:24.823196904Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "demo-test-metron",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": undefined,
      "dstInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/sonarqube",
      "dstNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/demo-test-metron",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": undefined,
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
      "srcNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "summary": "REACHABLE",
    },
    {
      "_class": [
        "Assessment",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-c",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "createTime": "2024-05-14T13:13:28.690753564Z",
            "destination": {
              "instance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
              "ipAddress": "10.128.15.223",
              "network": "projects/j1-gc-integration-dev-v3/global/networks/default",
              "port": 80,
            },
            "displayName": "test-c",
            "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-c",
            "probingDetails": {
              "probingLatency": {
                "latencyPercentiles": [
                  {
                    "latencyMicros": "15175",
                    "percent": 50,
                  },
                  {
                    "latencyMicros": "15255",
                    "percent": 95,
                  },
                ],
              },
              "result": "REACHABLE",
              "sentProbeCount": 50,
              "successfulProbeCount": 50,
              "verifyTime": "2024-05-14T13:13:35.309106Z",
            },
            "protocol": "TCP",
            "reachabilityDetails": {
              "result": "REACHABLE",
              "traces": [
                {
                  "endpointInfo": {
                    "destinationIp": "10.128.15.223",
                    "destinationNetworkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                    "destinationPort": 80,
                    "protocol": "TCP",
                    "sourcePort": 64453,
                  },
                  "forwardTraceId": 1,
                  "steps": [
                    {
                      "cloudFunction": {
                        "displayName": "function-2",
                        "location": "northamerica-northeast1",
                        "uri": "projects/j1-gc-integration-dev-v3/locations/northamerica-northeast1/functions/function-2",
                        "versionId": "3",
                      },
                      "description": "Initial state: packet originating from a Cloud function.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "START_FROM_CLOUD_FUNCTION",
                    },
                    {
                      "description": "Forwarding state: arriving at a VPC connector.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ARRIVE_AT_VPC_CONNECTOR",
                      "vpcConnector": {
                        "displayName": "test",
                        "location": "northamerica-northeast1",
                        "uri": "projects/j1-gc-integration-dev-v3/locations/northamerica-northeast1/connectors/test",
                      },
                    },
                    {
                      "description": "Config checking state: verify EGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "EGRESS",
                        "displayName": "default-allow-egress",
                        "firewallRuleType": "IMPLIED_VPC_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 65535,
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_EGRESS_FIREWALL_RULE",
                    },
                    {
                      "description": "Config checking state: verify route.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "route": {
                        "destIpRange": "10.128.0.0/20",
                        "displayName": "default-route-3983b63c88b8bd67",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "nextHop": "network gateway",
                        "nextHopType": "NEXT_HOP_NETWORK",
                        "routeScope": "NETWORK",
                        "routeType": "SUBNET",
                        "uri": "projects/j1-gc-integration-dev-v3/global/routes/default-route-3983b63c88b8bd67",
                      },
                      "state": "APPLY_ROUTE",
                    },
                    {
                      "description": "Forwarding state: arriving at a Compute Engine instance.",
                      "instance": {
                        "displayName": "instance-1",
                        "externalIp": "34.172.130.250",
                        "interface": "nic0",
                        "internalIp": "10.128.15.223",
                        "networkTags": [
                          "http-server",
                          "https-server",
                        ],
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "uri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "ARRIVE_AT_INSTANCE",
                    },
                    {
                      "description": "Config checking state: verify INGRESS firewall rule.",
                      "firewall": {
                        "action": "ALLOW",
                        "direction": "INGRESS",
                        "displayName": "Service managed firewall rule for Serverless VPC Access",
                        "firewallRuleType": "SERVERLESS_VPC_ACCESS_MANAGED_FIREWALL_RULE",
                        "networkUri": "projects/j1-gc-integration-dev-v3/global/networks/default",
                        "priority": 1000,
                      },
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "APPLY_INGRESS_FIREWALL_RULE",
                    },
                    {
                      "deliver": {
                        "ipAddress": "10.128.15.223",
                        "resourceUri": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
                        "target": "INSTANCE",
                      },
                      "description": "Final state: packet delivered to instance.",
                      "projectId": "j1-gc-integration-dev-v3",
                      "state": "DELIVER",
                    },
                  ],
                },
              ],
              "verifyTime": "2024-05-14T13:13:45.562460862Z",
            },
            "source": {
              "cloudFunction": {
                "uri": "projects/j1-gc-integration-dev-v3/locations/northamerica-northeast1/functions/function-2",
              },
            },
            "updateTime": "2024-05-14T13:13:45.611377727Z",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer_connectivity_test",
      "category": "TCP",
      "createdOn": undefined,
      "displayName": "test-c",
      "dstAppEngineVersion": undefined,
      "dstCloudFunction": undefined,
      "dstCloudSqlInstance": undefined,
      "dstForwardingRule": undefined,
      "dstInstance": "projects/j1-gc-integration-dev-v3/zones/us-central1-a/instances/instance-1",
      "dstNetwork": "projects/j1-gc-integration-dev-v3/global/networks/default",
      "internal": true,
      "name": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-c",
      "projectId": "j1-gc-integration-dev-v3",
      "srcAppEngineVersion": undefined,
      "srcCloudFunction": "projects/j1-gc-integration-dev-v3/locations/northamerica-northeast1/functions/function-2",
      "srcCloudSqlInstance": undefined,
      "srcForwardingRule": undefined,
      "srcInstance": undefined,
      "srcNetwork": undefined,
      "summary": "REACHABLE",
    },
    {
      "_class": [
        "Service",
      ],
      "_key": "projects/j1-gc-integration-dev-v3/locations/global",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "locationId": "global",
            "name": "projects/j1-gc-integration-dev-v3/locations/global",
          },
        },
      ],
      "_type": "google_cloud_network_analyzer",
      "category": [
        "network",
      ],
      "createdOn": undefined,
      "displayName": "projects/j1-gc-integration-dev-v3/locations/global",
      "function": [
        "networking",
      ],
      "locationId": "global",
      "name": "projects/j1-gc-integration-dev-v3/locations/global",
      "projectId": "j1-gc-integration-dev-v3",
    },
  ],
  "collectedRelationships": [
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/gke-cluster",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/gke-cluster",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-ooi",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-ooi",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-conn-1",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-conn-1",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-connection-02",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-connection-02",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/connectivity-test-for-vpc-network",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/connectivity-test-for-vpc-network",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/bharat-001",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/bharat-001",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/cloud-run",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/cloud-run",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/rule",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/rule",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/load-balancer-01",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/load-balancer-01",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/demo-test-metron",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/demo-test-metron",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
    {
      "_class": "HAS",
      "_fromEntityKey": "projects/j1-gc-integration-dev-v3/locations/global",
      "_key": "projects/j1-gc-integration-dev-v3/locations/global|has|projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-c",
      "_toEntityKey": "projects/j1-gc-integration-dev-v3/locations/global/connectivityTests/test-c",
      "_type": "google_cloud_network_analyzer_has_connectivity_test",
      "displayName": "HAS",
    },
  ],
  "encounteredTypes": [
    "google_cloud_network_analyzer_connectivity_test",
    "google_cloud_network_analyzer",
    "google_cloud_network_analyzer_has_connectivity_test",
  ],
  "numCollectedEntities": 12,
  "numCollectedRelationships": 11,
}
`;

exports[`networkAnalyzer#build-vpn-gateway-uses-vpn-gateway-tunnel-relationship should collect data 1`] = `
{
  "collectedEntities": [
    {
      "_class": [
        "Gateway",
      ],
      "_key": "demo-vpn-gateway",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "creationTimestamp": "2024-04-23T23:16:17.360-07:00",
            "gatewayIpVersion": "IPV4",
            "id": "5169371474615934302",
            "kind": "compute#vpnGateway",
            "labelFingerprint": "42WmSpB8rSM=",
            "name": "demo-vpn-gateway",
            "network": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/global/networks/default",
            "region": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-central1",
            "selfLink": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-central1/vpnGateways/demo-vpn-gateway",
            "stackType": "IPV4_ONLY",
            "vpnInterfaces": [
              {
                "id": 0,
                "ipAddress": "34.157.99.170",
              },
              {
                "id": 1,
                "ipAddress": "35.220.75.52",
              },
            ],
          },
        },
      ],
      "_type": "google_cloud_vpn_gateway",
      "category": [
        "network",
      ],
      "createdOn": 1713939377360,
      "displayName": "demo-vpn-gateway",
      "function": [
        "routing",
        "remote-access-gateway",
      ],
      "id": "5169371474615934302",
      "kind": "compute#vpnGateway",
      "name": "demo-vpn-gateway",
      "projectId": "j1-gc-integration-dev-v3",
      "public": true,
      "summary": undefined,
    },
    {
      "_class": [
        "Gateway",
      ],
      "_key": "demo-vpn-gateway-2",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "creationTimestamp": "2024-04-23T23:26:08.398-07:00",
            "gatewayIpVersion": "IPV4",
            "id": "506472523849079023",
            "kind": "compute#vpnGateway",
            "labelFingerprint": "42WmSpB8rSM=",
            "name": "demo-vpn-gateway-2",
            "network": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/global/networks/default",
            "region": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-east1",
            "selfLink": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-east1/vpnGateways/demo-vpn-gateway-2",
            "stackType": "IPV4_ONLY",
            "vpnInterfaces": [
              {
                "id": 0,
                "ipAddress": "35.242.10.161",
              },
              {
                "id": 1,
                "ipAddress": "35.220.8.175",
              },
            ],
          },
        },
      ],
      "_type": "google_cloud_vpn_gateway",
      "category": [
        "network",
      ],
      "createdOn": 1713939968398,
      "displayName": "demo-vpn-gateway-2",
      "function": [
        "routing",
        "remote-access-gateway",
      ],
      "id": "506472523849079023",
      "kind": "compute#vpnGateway",
      "name": "demo-vpn-gateway-2",
      "projectId": "j1-gc-integration-dev-v3",
      "public": true,
      "summary": undefined,
    },
    {
      "_class": [
        "Gateway",
      ],
      "_key": "demo-vpn-tunnel",
      "_rawData": [
        {
          "name": "default",
          "rawData": {
            "creationTimestamp": "2024-04-24T00:08:43.251-07:00",
            "description": "",
            "detailedStatus": "No incoming packets from peer",
            "id": "5333968030286549268",
            "ikeVersion": 2,
            "kind": "compute#vpnTunnel",
            "labelFingerprint": "42WmSpB8rSM=",
            "localTrafficSelector": [
              "0.0.0.0/0",
            ],
            "name": "demo-vpn-tunnel",
            "peerExternalGateway": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/global/externalVpnGateways/demo-peer-gateway",
            "peerExternalGatewayInterface": 0,
            "peerIp": "12.120.12.33",
            "region": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-central1",
            "remoteTrafficSelector": [
              "0.0.0.0/0",
            ],
            "router": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-central1/routers/demo-router2",
            "selfLink": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-central1/vpnTunnels/demo-vpn-tunnel",
            "sharedSecret": "*************",
            "sharedSecretHash": "4bcIUgeMVskvZeiR0f8c9n4s1AaP",
            "status": "NO_INCOMING_PACKETS",
            "vpnGateway": "https://www.googleapis.com/compute/v1/projects/j1-gc-integration-dev-v3/regions/us-central1/vpnGateways/demo-vpn-gateway",
            "vpnGatewayInterface": 1,
          },
        },
      ],
      "_type": "google_cloud_vpn_tunnel",
      "active": undefined,
      "category": [
        "network",
      ],
      "createdOn": 1713942523251,
      "description": "",
      "displayName": "demo-vpn-tunnel",
      "function": [
        "routing",
      ],
      "id": "5333968030286549268",
      "kind": "compute#vpnTunnel",
      "name": "demo-vpn-tunnel",
      "projectId": "j1-gc-integration-dev-v3",
      "public": true,
      "status": "NO_INCOMING_PACKETS",
      "summary": "",
      "vpnGatewayName": "demo-vpn-gateway",
    },
  ],
  "collectedRelationships": [
    {
      "_class": "USES",
      "_fromEntityKey": "demo-vpn-gateway",
      "_key": "demo-vpn-gateway|uses|demo-vpn-tunnel",
      "_toEntityKey": "demo-vpn-tunnel",
      "_type": "google_cloud_vpn_gateway_uses_tunnel",
      "displayName": "USES",
    },
  ],
  "encounteredTypes": [
    "google_cloud_vpn_gateway",
    "google_cloud_vpn_tunnel",
    "google_cloud_vpn_gateway_uses_tunnel",
  ],
  "numCollectedEntities": 3,
  "numCollectedRelationships": 1,
}
`;
